<div class="container mt-4">
  <h2>ðŸ›’ Place Order</h2>

  <div *ngIf="cartItems.length === 0" class="alert alert-info text-center">
    Your cart is empty.
  </div>

  <div *ngIf="cartItems.length > 0">
    <!-- Order Summary -->
    <div class="card mb-3">
      <div class="card-header">
        <h5 class="mb-0">Order Summary</h5>
      </div>
      <div class="card-body">
        <div *ngFor="let item of cartItems" class="d-flex justify-content-between align-items-center mb-2">
          <div>
            <h6 class="mb-1">{{ item.product.name }}</h6>
            <small class="text-muted">Quantity: {{ item.quantity }} Ã— {{ item.product.price | currency }}</small>
          </div>
          <div class="text-end">
            <strong>{{ item.quantity * item.product.price | currency }}</strong>
          </div>
        </div>
        <hr>
        <div class="d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Total:</h5>
          <h5 class="mb-0 text-primary">{{ totalAmount | currency }}</h5>
        </div>
      </div>
    </div>

    <!-- Delivery Details Form -->
    <div class="card mb-3">
      <div class="card-header">
        <h5 class="mb-0">Delivery Details</h5>
      </div>
      <div class="card-body">
        <form [formGroup]="deliveryForm" (ngSubmit)="placeOrder()">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="name" class="form-label">Full Name *</label>
              <input 
                type="text" 
                class="form-control" 
                id="name" 
                formControlName="name"
                [class.is-invalid]="deliveryForm.get('name')?.invalid && deliveryForm.get('name')?.touched"
                placeholder="Enter your full name">
              <div class="invalid-feedback" *ngIf="deliveryForm.get('name')?.invalid && deliveryForm.get('name')?.touched">
                <span *ngIf="deliveryForm.get('name')?.errors?.['required']">Name is required</span>
             <span *ngIf="deliveryForm.get('name')?.errors?.['pattern']">Name can contain only letters and spaces</span>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="phone" class="form-label">Phone Number *</label>
              <input 
                type="tel" 
                class="form-control" 
                id="phone" 
                formControlName="phone"
                [class.is-invalid]="deliveryForm.get('phone')?.invalid && deliveryForm.get('phone')?.touched"
                placeholder="Enter your phone number">
              <div class="invalid-feedback" *ngIf="deliveryForm.get('phone')?.invalid && deliveryForm.get('phone')?.touched">
                <span *ngIf="deliveryForm.get('phone')?.errors?.['required']">Phone number is required</span>
             <span *ngIf="deliveryForm.get('phone')?.errors?.['pattern']">Enter a valid phone number (7-15 digits)</span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="house" class="form-label">House/Street Address *</label>
              <input 
                type="text" 
                class="form-control" 
                id="house" 
                formControlName="house"
                [class.is-invalid]="deliveryForm.get('house')?.invalid && deliveryForm.get('house')?.touched"
                placeholder="Enter your house/street address">
              <div class="invalid-feedback" *ngIf="deliveryForm.get('house')?.invalid && deliveryForm.get('house')?.touched">
                <span *ngIf="deliveryForm.get('house')?.errors?.['required']">Address is required</span>
                <!-- <span *ngIf="deliveryForm.get('house')?.errors?.['pattern']">Name can contain only letters and spaces</span> -->
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="country" class="form-label">Country *</label>
              <input 
                type="text" 
                class="form-control" 
                id="country" 
                formControlName="country"
                [class.is-invalid]="deliveryForm.get('country')?.invalid && deliveryForm.get('country')?.touched"
                placeholder="Enter your country">
              <div class="invalid-feedback" *ngIf="deliveryForm.get('country')?.invalid && deliveryForm.get('country')?.touched">
                <span *ngIf="deliveryForm.get('country')?.errors?.['required']">Country is required</span>
                <!-- <span *ngIf="deliveryForm.get('country')?.errors?.['minlength']">Country must be at least 2 characters</span> -->
              </div>
            </div>
          </div>
          
          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <button 
              type="submit" 
              class="btn btn-primary btn-lg" 
              [disabled]="!isFormValid || cartItems.length === 0">
              Place Order - {{ totalAmount | currency }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
